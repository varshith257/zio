"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[97257],{15680:(e,r,t)=>{t.d(r,{xA:()=>c,yg:()=>y});var s=t(96540);function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,s)}return t}function a(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){n(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function i(e,r){if(null==e)return{};var t,s,n=function(e,r){if(null==e)return{};var t,s,n={},o=Object.keys(e);for(s=0;s<o.length;s++)t=o[s],r.indexOf(t)>=0||(n[t]=e[t]);return n}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)t=o[s],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var p=s.createContext({}),l=function(e){var r=s.useContext(p),t=r;return e&&(t="function"==typeof e?e(r):a(a({},r),e)),t},c=function(e){var r=l(e.components);return s.createElement(p.Provider,{value:r},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var r=e.children;return s.createElement(s.Fragment,{},r)}},g=s.forwardRef((function(e,r){var t=e.components,n=e.mdxType,o=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=l(t),g=n,y=m["".concat(p,".").concat(g)]||m[g]||d[g]||o;return t?s.createElement(y,a(a({ref:r},c),{},{components:t})):s.createElement(y,a({ref:r},c))}));function y(e,r){var t=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var o=t.length,a=new Array(o);a[0]=g;var i={};for(var p in r)hasOwnProperty.call(r,p)&&(i[p]=r[p]);i.originalType=e,i[m]="string"==typeof e?e:n,a[1]=i;for(var l=2;l<o;l++)a[l]=t[l];return s.createElement.apply(null,a)}return s.createElement.apply(null,t)}g.displayName="MDXCreateElement"},82094:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>p,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var s=t(58168),n=(t(96540),t(15680));const o={id:"index",title:"Compression and archives with zio-streams",sidebar_label:"ZIO Streams Compress"},a=void 0,i={unversionedId:"zio-streams-compress/index",id:"zio-streams-compress/index",title:"Compression and archives with zio-streams",description:"ZIO Streams Compress integrates several compression algorithms and",source:"@site/docs/zio-streams-compress/index.md",sourceDirName:"zio-streams-compress",slug:"/zio-streams-compress/",permalink:"/zio-streams-compress/",draft:!1,editUrl:"https://github.com/zio/zio/edit/series/2.x/docs/zio-streams-compress/index.md",tags:[],version:"current",frontMatter:{id:"index",title:"Compression and archives with zio-streams",sidebar_label:"ZIO Streams Compress"},sidebar:"ecosystem-sidebar",previous:{title:"Combining Different Encoders",permalink:"/zio-schema/examples/combining-different-encoders"},next:{title:"ZIO Telemetry",permalink:"/zio-telemetry/"}},p={},l=[{value:"Installation",id:"installation",level:2},{value:"Example",id:"example",level:3},{value:"Running the tests",id:"running-the-tests",level:2}],c={toc:l},m="wrapper";function d(e){let{components:r,...t}=e;return(0,n.yg)(m,(0,s.A)({},c,t,{components:r,mdxType:"MDXLayout"}),(0,n.yg)("p",null,(0,n.yg)("a",{parentName:"p",href:"https://github.com/zio/zio-streams-compress"},"ZIO Streams Compress")," integrates several compression algorithms and\narchive formats with ",(0,n.yg)("a",{parentName:"p",href:"https://zio.dev"},"ZIO Streams"),"."),(0,n.yg)("p",null,(0,n.yg)("a",{parentName:"p",href:"https://github.com/zio/zio/wiki/Project-Stages"},(0,n.yg)("img",{parentName:"a",src:"https://img.shields.io/badge/Project%20Stage-Production%20Ready-brightgreen.svg",alt:"Production Ready"}))," ",(0,n.yg)("img",{parentName:"p",src:"https://github.com/zio/zio-streams-compress/workflows/CI/badge.svg",alt:"CI Badge"})," ",(0,n.yg)("a",{parentName:"p",href:"https://oss.sonatype.org/content/repositories/releases/dev/zio/zio-streams-compress-docs_2.13/"},(0,n.yg)("img",{parentName:"a",src:"https://img.shields.io/nexus/r/https/oss.sonatype.org/dev.zio/zio-streams-compress-docs_2.13.svg?label=Sonatype%20Release",alt:"Sonatype Releases"}))," ",(0,n.yg)("a",{parentName:"p",href:"https://oss.sonatype.org/content/repositories/snapshots/dev/zio/zio-streams-compress-docs_2.13/"},(0,n.yg)("img",{parentName:"a",src:"https://img.shields.io/nexus/s/https/oss.sonatype.org/dev.zio/zio-streams-compress-docs_2.13.svg?label=Sonatype%20Snapshot",alt:"Sonatype Snapshots"}))," ",(0,n.yg)("a",{parentName:"p",href:"https://javadoc.io/doc/dev.zio/zio-streams-compress-docs_2.13"},(0,n.yg)("img",{parentName:"a",src:"https://javadoc.io/badge2/dev.zio/zio-streams-compress-docs_2.13/javadoc.svg",alt:"javadoc"}))," ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/zio/zio-streams-compress"},(0,n.yg)("img",{parentName:"a",src:"https://img.shields.io/github/stars/zio/zio-streams-compress?style=social",alt:"ZIO Streams Compress docs"}))," ",(0,n.yg)("a",{parentName:"p",href:"https://scala-steward.org"},(0,n.yg)("img",{parentName:"a",src:"https://img.shields.io/badge/Scala_Steward-helping-blue.svg?style=flat&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAMAAAARSr4IAAAAVFBMVEUAAACHjojlOy5NWlrKzcYRKjGFjIbp293YycuLa3pYY2LSqql4f3pCUFTgSjNodYRmcXUsPD/NTTbjRS+2jomhgnzNc223cGvZS0HaSD0XLjbaSjElhIr+AAAAAXRSTlMAQObYZgAAAHlJREFUCNdNyosOwyAIhWHAQS1Vt7a77/3fcxxdmv0xwmckutAR1nkm4ggbyEcg/wWmlGLDAA3oL50xi6fk5ffZ3E2E3QfZDCcCN2YtbEWZt+Drc6u6rlqv7Uk0LdKqqr5rk2UCRXOk0vmQKGfc94nOJyQjouF9H/wCc9gECEYfONoAAAAASUVORK5CYII=",alt:"Scala Steward badge"}))),(0,n.yg)("h1",{id:"we-are-open-for-comments"},"We are open for comments"),(0,n.yg)("p",null,"Please ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/zio/zio-streams-compress/issues/new"},"open an issue")," or contact us\non ",(0,n.yg)("a",{parentName:"p",href:"https://discord.com/channels/629491597070827530/630498701860929559"},"Discord")," if you have suggestions. The API will\nstabilize in Jan 2025, followed by a 1.0.0 release."),(0,n.yg)("h2",{id:"installation"},"Installation"),(0,n.yg)("p",null,"In order to use this library, we need to add one of the following line in our ",(0,n.yg)("inlineCode",{parentName:"p"},"build.sbt")," file:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-sbt"},'libraryDependencies += "dev.zio" %% "zio-streams-compress-brotli" % "0.0.2"\nlibraryDependencies += "dev.zio" %% "zio-streams-compress-brotli4j" % "0.0.2"\nlibraryDependencies += "dev.zio" %% "zio-streams-compress-bzip2" % "0.0.2"\nlibraryDependencies += "dev.zio" %% "zio-streams-compress-gzip" % "0.0.2"\nlibraryDependencies += "dev.zio" %% "zio-streams-compress-lz4" % "0.0.2"\nlibraryDependencies += "dev.zio" %% "zio-streams-compress-tar" % "0.0.2"\nlibraryDependencies += "dev.zio" %% "zio-streams-compress-zip" % "0.0.2"\nlibraryDependencies += "dev.zio" %% "zio-streams-compress-zip4j" % "0.0.2"\nlibraryDependencies += "dev.zio" %% "zio-streams-compress-zstd" % "0.0.2"\n')),(0,n.yg)("p",null,"For Brotli you can choose between the 'brotli' and the 'brotli4j' version. The first is based on the official Java\nlibrary but only does decompression. The second is based on ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/hyperxpro/Brotli4j"},"Brotli4J")," which does\ncompression and decompression."),(0,n.yg)("p",null,"For ZIP files you can choose between the 'zip' and the 'zip4j' version. The first allows you to tweak the compression\nlevel, while the second allows you work with password-protected ZIP files."),(0,n.yg)("p",null,"Currently only jvm is supported. PRs for scala-js and scala-native are welcome."),(0,n.yg)("h3",{id:"example"},"Example"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-scala"},'// Example.sc\n// Run with: scala-cli Example.sc\n//> using dep dev.zio:zio-streams-compress-gzip:0.0.2\n//> using dep dev.zio:zio-streams-compress-tar:0.0.2\n//> using dep dev.zio:zio-streams-compress-zip4j:0.0.2\n\nimport zio._\nimport zio.compress.{ArchiveEntry, GzipCompressor, GzipDecompressor, TarUnarchiver, Zip4JArchiver}\nimport zio.stream._\n\nimport java.nio.charset.StandardCharsets.UTF_8\n\nobject ExampleApp extends ZIOAppDefault {\n  override def run: ZIO[Any, Any, Any] =\n    for {\n      // Compress a file with GZIP\n      _ <- ZStream\n             .fromFileName("file")\n             .via(GzipCompressor.compress)\n             .run(ZSink.fromFileName("file.gz"))\n\n      // List all items in a gzip tar archive:\n      _ <- ZStream\n             .fromFileName("file.tgz")\n             .via(GzipDecompressor.decompress)\n             .via(TarUnarchiver.unarchive)\n             .mapZIO { case (archiveEntry, contentStream) =>\n               for {\n                 content <- contentStream.runCollect\n                 _ <- Console.printLine(s"${archiveEntry.name} ${content.length}")\n               } yield ()\n             }\n             .runDrain\n\n      // Create an encrypted ZIP archive\n      _ <- ZStream(archiveEntry("file1.txt", "Hello world!".getBytes(UTF_8)))\n             .via(Zip4JArchiver(password = Some("it is a secret")).archive)\n             .run(ZSink.fromFileName("file.zip"))\n    } yield ()\n\n  private def archiveEntry(\n    name: String,\n    content: Array[Byte],\n  ): (ArchiveEntry[Some, Any], ZStream[Any, Throwable, Byte]) =\n    (ArchiveEntry(name, Some(content.length.toLong)), ZStream.fromIterable(content))\n\n}\n')),(0,n.yg)("h2",{id:"running-the-tests"},"Running the tests"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-shell"},'SBT_OPTS="-Xmx4G -XX:+UseG1GC" sbt test\n')))}d.isMDXComponent=!0}}]);