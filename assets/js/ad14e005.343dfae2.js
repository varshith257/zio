"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[56325],{15680:(e,n,t)=>{t.d(n,{xA:()=>s,yg:()=>y});var a=t(96540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=a.createContext({}),d=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},s=function(e){var n=d(e.components);return a.createElement(p.Provider,{value:n},e.children)},m="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},h=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),m=d(t),h=r,y=m["".concat(p,".").concat(h)]||m[h]||g[h]||o;return t?a.createElement(y,i(i({ref:n},s),{},{components:t})):a.createElement(y,i({ref:n},s))}));function y(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,i=new Array(o);i[0]=h;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l[m]="string"==typeof e?e:r,i[1]=l;for(var d=2;d<o;d++)i[d]=t[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}h.displayName="MDXCreateElement"},4544:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>i,default:()=>g,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var a=t(58168),r=(t(96540),t(15680));const o={id:"handler",title:"Request Handler"},i=void 0,l={unversionedId:"zio-http/reference/handler",id:"zio-http/reference/handler",title:"Request Handler",description:"A Handler is responsible for processing the matched incoming request and generating an appropriate response. It is a function that takes a Request and produces a Response. Thus, it is a crucial component of the ZIO HTTP that determines how the server should respond to a request matched by the corresponding RoutePattern.",source:"@site/docs/zio-http/reference/handler.md",sourceDirName:"zio-http/reference",slug:"/zio-http/reference/handler",permalink:"/zio-http/reference/handler",draft:!1,editUrl:"https://github.com/zio/zio/edit/series/2.x/docs/zio-http/reference/handler.md",tags:[],version:"current",frontMatter:{id:"handler",title:"Request Handler"},sidebar:"ecosystem-sidebar",previous:{title:"PathCodec",permalink:"/zio-http/reference/routing/path_codec"},next:{title:"Request",permalink:"/zio-http/reference/request"}},p={},d=[{value:"Definition",id:"definition",level:2},{value:"Creating a Handler",id:"creating-a-handler",level:2},{value:"Handler Constructors",id:"handler-constructors",level:2},{value:"Handler.ok",id:"handlerok",level:3},{value:"Succeed/Fail/Die",id:"succeedfaildie",level:3},{value:"Importing non-ZIO Code",id:"importing-non-zio-code",level:3},{value:"From <code>Either</code> and <code>Exit</code>",id:"from-either-and-exit",level:3},{value:"First Success",id:"first-success",level:3},{value:"From ZIO Effect",id:"from-zio-effect",level:3},{value:"From Response",id:"from-response",level:3},{value:"From ZIO Stream",id:"from-zio-stream",level:3},{value:"From HTML, Text, and Template",id:"from-html-text-and-template",level:3},{value:"Creating a Plain Text Response",id:"creating-a-plain-text-response",level:4},{value:"Creating an HTML Response",id:"creating-an-html-response",level:4},{value:"Creating an HTML Response Using Template",id:"creating-an-html-response-using-template",level:4},{value:"Timeout Handler",id:"timeout-handler",level:3},{value:"Status Codes",id:"status-codes",level:3},{value:"Handler.error",id:"handlererror",level:3},{value:"Creating a Handler From Body",id:"creating-a-handler-from-body",level:3},{value:"Creating a Bounded Body Consumer",id:"creating-a-bounded-body-consumer",level:3},{value:"From Function",id:"from-function",level:3},{value:"From File",id:"from-file",level:3},{value:"Parameter Extractor",id:"parameter-extractor",level:3},{value:"Websocket",id:"websocket",level:3},{value:"Stack Trace",id:"stack-trace",level:3},{value:"Handler Operators",id:"handler-operators",level:2},{value:"Handler Aspect",id:"handler-aspect",level:3},{value:"Sandboxing Errors",id:"sandboxing-errors",level:3},{value:"Converting a <code>Handler</code> to an <code>Routes</code>",id:"converting-a-handler-to-an-routes",level:3},{value:"Response Projections",id:"response-projections",level:3},{value:"Running Handler",id:"running-handler",level:3},{value:"Mapping",id:"mapping",level:3},{value:"Composing Handlers",id:"composing-handlers",level:3},{value:"Error Management",id:"error-management",level:3},{value:"Working with Environment and Layers",id:"working-with-environment-and-layers",level:3},{value:"Adding Delays",id:"adding-delays",level:3},{value:"Converting to Constant Values/Types",id:"converting-to-constant-valuestypes",level:3},{value:"Overwriting the <code>Method</code>",id:"overwriting-the-method",level:3},{value:"Patching the <code>Response</code>",id:"patching-the-response",level:3}],s={toc:d},m="wrapper";function g(e){let{components:n,...t}=e;return(0,r.yg)(m,(0,a.A)({},s,t,{components:n,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"A ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," is responsible for processing the matched incoming request and generating an appropriate response. It is a function that takes a ",(0,r.yg)("inlineCode",{parentName:"p"},"Request")," and produces a ",(0,r.yg)("inlineCode",{parentName:"p"},"Response"),". Thus, it is a crucial component of the ZIO HTTP that determines how the server should respond to a request matched by the corresponding ",(0,r.yg)("inlineCode",{parentName:"p"},"RoutePattern"),"."),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"In ZIO HTTP, each ",(0,r.yg)("inlineCode",{parentName:"p"},"Route")," consists of a ",(0,r.yg)("inlineCode",{parentName:"p"},"RoutePattern")," and a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler"),". The ",(0,r.yg)("inlineCode",{parentName:"p"},"RoutePattern")," is responsible for matching the ",(0,r.yg)("strong",{parentName:"p"},"method")," and ",(0,r.yg)("strong",{parentName:"p"},"path")," of the incoming request, while the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," specifies the corresponding action to be taken when the request is matched.")),(0,r.yg)("h2",{id:"definition"},"Definition"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Hander")," trait is defined as follows:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"sealed trait Handler[-R, +Err, -In, +Out] {\n  def apply(in: In): ZIO[R, Err, Out]\n}\n")),(0,r.yg)("p",null,"It has four type parameters. The first two parameters ",(0,r.yg)("inlineCode",{parentName:"p"},"R")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"Err")," are the environment and error type of the underlying effect that the handler represents. The third and fourth parameters ",(0,r.yg)("inlineCode",{parentName:"p"},"In")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"Out")," are the input and output types of the handler."),(0,r.yg)("p",null,"If the input type of the handler is ",(0,r.yg)("inlineCode",{parentName:"p"},"Request")," and the output type is ",(0,r.yg)("inlineCode",{parentName:"p"},"Response"),", we call that handler a ",(0,r.yg)("strong",{parentName:"p"},"request handler"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"type RequestHandler[-R, +Err] = Handler[R, Err, Request, Response]\n")),(0,r.yg)("h2",{id:"creating-a-handler"},"Creating a Handler"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," trait comes with a companion object that has different methods to create handlers for various needs."),(0,r.yg)("p",null,"Additionally, there's a smart constructor called ",(0,r.yg)("inlineCode",{parentName:"p"},"handler")," in the ",(0,r.yg)("inlineCode",{parentName:"p"},"zio.http")," package. It automatically picks the right handler constructor based on the input type. Usually, using ",(0,r.yg)("inlineCode",{parentName:"p"},"handler")," is enough, but if we need more control and specificity, we can also use the methods in the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," companion object."),(0,r.yg)("p",null,"Let's look at some examples of creating handlers, using the ",(0,r.yg)("inlineCode",{parentName:"p"},"handler")," smart constructor:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio._\nimport zio.http._\n\nRoutes(\n\n  // 1. A simple handler that returns a "Hello, World!" response\n  Method.GET / "hello" -> \n    handler(Response.text("Hello, World!")),\n  \n  // 2. A handler that echoes the request body\n  Method.POST / "echo" ->\n    handler { (req: Request) => req.body.asString(Charsets.Utf8).map(Response.text(_)).orDie },\n\n  // 3. A handler that generates a random UUID\n  Method.GET / "uuid" -> \n    handler(Random.nextUUID.map(u => Response.text(u.toString))),\n\n  // 4. A handler that takes the name from the path and returns a greeting message\n  Method.GET / "name" / string("name") -> \n    handler{ (name: String, _: Request) => Response.text(s"Hello, $name!") },\n\n  // 5. A handler that takes the name and age from the path and returns birthday greetings\n  Method.GET / "name" / string("name") / "age" / int("age") ->\n    handler{ (name: String, age: Int, _: Request) => Response.text(s"Happy $age-th birthday, $name!") }\n\n)\n// res0: Routes[Any, Nothing] = Routes(\n//   routes = IndexedSeq(\n//     Handled(\n//       routePattern = RoutePattern(\n//         method = GET,\n//         pathCodec = Concat(\n//           left = Segment(segment = Empty),\n//           right = Segment(segment = Literal(value = "hello")),\n//           combiner = zio.http.codec.Combiner$$anon$1@1112f5fd\n//         )\n//       ),\n//       handler = zio.http.Handler$FromFunction$$anon$16@7a6fd5ea,\n//       location = ""\n//     ),\n//     Handled(\n//       routePattern = RoutePattern(\n//         method = POST,\n//         pathCodec = Concat(\n//           left = Segment(segment = Empty),\n//           right = Segment(segment = Literal(value = "echo")),\n//           combiner = zio.http.codec.Combiner$$anon$1@6de5475a\n//         )\n//       ),\n//       handler = zio.http.Handler$FromFunction$$anon$16@65c1db65,\n//       location = ""\n//     ),\n//     Handled(\n//       routePattern = RoutePattern(\n//         method = GET,\n//         pathCodec = Concat(\n//           left = Segment(segment = Empty),\n//           right = Segment(segment = Literal(value = "uuid")),\n//           combiner = zio.http.codec.Combiner$$anon$1@637a673d\n//         )\n//       ),\n//       handler = zio.http.Handler$FromFunction$$anon$16@67be3e3d,\n//       location = ""\n//     ),\n//     Unhandled(\n//       routePattern = RoutePattern(\n//         method = GET,\n//         pathCodec = Concat(\n//           left = Concat(\n//             left = Segment(segment = Empty),\n//             right = Segment(segment = Literal(value = "name")),\n//             combiner = zio.http.codec.Combiner$$anon$1@20266a07\n//           ),\n//           right = Segment(segment = Text(name = "name")),\n//           combiner = zio.http.codec.Combiner$$anon$1@4bd79795\n// ...\n')),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"Please be aware that this page primarily concentrates on the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," data type and its constructors. However, to provide a more comprehensive understanding within the context of routes, we also integrate examples with the ",(0,r.yg)("inlineCode",{parentName:"p"},"Routes")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"Method")," data types. Detailed exploration of the ",(0,r.yg)("inlineCode",{parentName:"p"},"Routes")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"Method")," data types will be discussed in a separate section.")),(0,r.yg)("p",null,"As we can see, the ",(0,r.yg)("inlineCode",{parentName:"p"},"handler")," constructor is quite versatile and can be used to create handlers for different use cases. It automatically infers proper handler constructors based on the input we pass to it."),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},'The first example shows a simple handler that only returns a "Hello, World!" response. It doesn\'t need any input, so we can directly pass the ',(0,r.yg)("inlineCode",{parentName:"p"},"Response")," to the ",(0,r.yg)("inlineCode",{parentName:"p"},"handler")," constructor.")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"The second example shows a handler that echoes the request body. Since it needs the request body, we pass a function that takes a ",(0,r.yg)("inlineCode",{parentName:"p"},"Request")," and returns a ",(0,r.yg)("inlineCode",{parentName:"p"},"Response"),"."),(0,r.yg)("admonition",{parentName:"li",type:"note"},(0,r.yg)("p",{parentName:"admonition"},"Please note that this handler employs the ",(0,r.yg)("inlineCode",{parentName:"p"},"orDie")," method to transform any failures in the effect into defects. In real-world applications, it's advisable to handle failures more gracefully, such as returning a descriptive error message in the response body. This approach provides clients with a clear understanding of what went wrong. We will delve into error handling in a separate section."))),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"The third example shows a handler that generates a random UUID. It doesn't need any input, but it requires an effect that produces a ",(0,r.yg)("inlineCode",{parentName:"p"},"UUID"),". So, we pass a ",(0,r.yg)("inlineCode",{parentName:"p"},"ZIO")," effect that generates a random ",(0,r.yg)("inlineCode",{parentName:"p"},"UUID")," and returns a ",(0,r.yg)("inlineCode",{parentName:"p"},"Response"),".")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"The fourth example shows a handler that takes the name from the path and returns a greeting message. It needs the name from the path, so we pass a function that takes a ",(0,r.yg)("inlineCode",{parentName:"p"},"String"),", (and also the ",(0,r.yg)("inlineCode",{parentName:"p"},"Request")," which we ignore it using ",(0,r.yg)("inlineCode",{parentName:"p"},"_"),"), and returns a ",(0,r.yg)("inlineCode",{parentName:"p"},"Response"),". Please note that whenever we need to access path parameters, we need also to pass the ",(0,r.yg)("inlineCode",{parentName:"p"},"Request")," as an argument to the handler function, even if we don't use it.")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"The fifth example is similar to the previous one, but it takes two path parameters."))),(0,r.yg)("h2",{id:"handler-constructors"},"Handler Constructors"),(0,r.yg)("p",null,"As mentioned earlier, it is advisable to use the ",(0,r.yg)("inlineCode",{parentName:"p"},"handler")," smart constructor for convenience. However, in some cases, we might use lower-level handler constructors. Let's look at some of the most commonly used handlers:"),(0,r.yg)("h3",{id:"handlerok"},"Handler.ok"),(0,r.yg)("p",null,"Creates a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that always responds with a 200 status code."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"Handler.ok\n")),(0,r.yg)("h3",{id:"succeedfaildie"},"Succeed/Fail/Die"),(0,r.yg)("p",null,"Like the ",(0,r.yg)("inlineCode",{parentName:"p"},"ZIO")," effect, we can create handlers that ",(0,r.yg)("inlineCode",{parentName:"p"},"succeed"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"fail"),", or ",(0,r.yg)("inlineCode",{parentName:"p"},"die")," using the following constructors:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'Handler.succeed(42)\n// res2: Handler[Any, Nothing, Any, Int] = zio.http.Handler$$anon$13@7ba4525d\n\nHandler.fail(new Error("Server Error!"))\n// res3: Handler[Any, Error, Any, Nothing] = zio.http.Handler$$anon$13@6dfdc4c2\n\nHandler.failCause(Cause.fail("Server Error!"))\n// res4: Handler[Any, String, Any, Nothing] = zio.http.Handler$$anon$13@7e18ed28\n\nHandler.die(new RuntimeException("Boom!"))\n// res5: Handler[Any, Nothing, Any, Nothing] = zio.http.Handler$$anon$13@984a641\n\nHandler.dieMessage("Boom!")\n// res6: Handler[Any, Nothing, Any, Nothing] = zio.http.Handler$$anon$13@50eb2b96\n')),(0,r.yg)("p",null,"Please note that the second type parameter of ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," is the error type. The ",(0,r.yg)("inlineCode",{parentName:"p"},"succeed")," handler doesn't have an error type (",(0,r.yg)("inlineCode",{parentName:"p"},"Nothing"),"), the ",(0,r.yg)("inlineCode",{parentName:"p"},"fail")," handler has an error type of the given error instance, and the ",(0,r.yg)("inlineCode",{parentName:"p"},"die")," handler has no error type (",(0,r.yg)("inlineCode",{parentName:"p"},"Nothing"),") which means it converted the error into a defect."),(0,r.yg)("admonition",{type:"info"},(0,r.yg)("p",{parentName:"admonition"},"ZIO boasts a robust error model, enabling us to manage errors in a type-safe and composable manner. If you're unfamiliar with ZIO, it's advisable to explore the ",(0,r.yg)("a",{parentName:"p",href:"https://zio.dev/reference/error-management/"},"Error Management")," section in the core ZIO documentation. This section provides insights into the principles of error handling within ZIO.")),(0,r.yg)("h3",{id:"importing-non-zio-code"},"Importing non-ZIO Code"),(0,r.yg)("p",null,"Sometimes we need to import a non ZIO code to a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler"),". The code may throw an exception and we want to capture all non-fatal exceptions while importing to the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler"),", in such cases we can use the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.attempt")," constructor. It takes a thunk of type ",(0,r.yg)("inlineCode",{parentName:"p"},"Out")," and returns a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that have ",(0,r.yg)("inlineCode",{parentName:"p"},"Throwable")," as the error type and result type as ",(0,r.yg)("inlineCode",{parentName:"p"},"Out"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"object Handler {\n  def attempt[Out](out: => Out): Handler[Any, Throwable, Any, Out] = ???\n}\n")),(0,r.yg)("p",null,"Sometimes it becomes necessary to integrate non-ZIO code into a Handler. The external code might be prone to throwing exceptions, so we need to seamlessly incorporate it into Handler while capturing all non-fatal exceptions. By utilizing this constructor, we can encapsulate a thunk of type ",(0,r.yg)("inlineCode",{parentName:"p"},"Out"),", resulting in a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," where the error type is ",(0,r.yg)("inlineCode",{parentName:"p"},"Throwable"),", while maintaining the original ",(0,r.yg)("inlineCode",{parentName:"p"},"Out")," as the result type."),(0,r.yg)("h3",{id:"from-either-and-exit"},"From ",(0,r.yg)("inlineCode",{parentName:"h3"},"Either")," and ",(0,r.yg)("inlineCode",{parentName:"h3"},"Exit")),(0,r.yg)("p",null,"If we have an ",(0,r.yg)("inlineCode",{parentName:"p"},"Either")," or ",(0,r.yg)("inlineCode",{parentName:"p"},"Exit")," which are the result of some computation, we can convert them to a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," using the corresponding constructors:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio._\nimport zio.http._\n\nHandler.fromExit(Exit.succeed(42))\n// res7: Handler[Any, Nothing, Any, Int] = zio.http.Handler$$anon$13@53b32e9d\nHandler.fromExit(Exit.fail("failed!"))\n// res8: Handler[Any, String, Any, Nothing] = zio.http.Handler$$anon$13@6afbe86e\n\nHandler.fromEither(Right(42))\n// res9: Handler[Any, Nothing, Any, Int] = zio.http.Handler$$anon$13@4661edde\nHandler.fromEither(Left("failed"))\n// res10: Handler[Any, String, Any, Nothing] = zio.http.Handler$$anon$13@4fdfd91f\n')),(0,r.yg)("h3",{id:"first-success"},"First Success"),(0,r.yg)("p",null,"If we have a list of handlers and we want to run them in sequence until the first success, we can use the ",(0,r.yg)("inlineCode",{parentName:"p"},"firstSuccessOf")," constructor:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'Handler.firstSuccessOf(\n  NonEmptyChunk(\n    Handler.notFound("Requested resource not found in cache!"),\n    Handler.succeed(Response.text("Requested resource found in database!")),\n    Handler.succeed(Response.text("Requested resource found on the remote server!"))\n  )\n)\n// res11: Handler[Any, Nothing, Any, Response] = zio.http.Handler$$anon$4@552c1bf\n')),(0,r.yg)("h3",{id:"from-zio-effect"},"From ZIO Effect"),(0,r.yg)("p",null,"We can easily convert a ",(0,r.yg)("inlineCode",{parentName:"p"},"ZIO")," effect to a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," using the ",(0,r.yg)("inlineCode",{parentName:"p"},"fromZIO")," constructor:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"Handler.fromZIO(ZIO.succeed(42))\n// res12: Handler[Any, Nothing, Any, Int] = zio.http.Handler$$anon$14@30dff1e3\n\nHandler.fromZIO(Random.nextUUID)\n// res13: Handler[Any, Nothing, Any, java.util.UUID] = zio.http.Handler$$anon$14@7919f53b\n")),(0,r.yg)("h3",{id:"from-response"},"From Response"),(0,r.yg)("p",null,"To create a handler that always returns a specific response, we can use the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.fromResponse")," constructor, or if we have a ",(0,r.yg)("inlineCode",{parentName:"p"},"ZIO")," effect that produces a response, we can use the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.fromResponseZIO")," constructor:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'Handler.fromResponse(Response.text("Hello, World!"))\n// res14: Handler[Any, Nothing, Any, Response] = zio.http.Handler$$anon$13@483fcc26\n\nHandler.fromResponseZIO(Random.nextUUID.map(u => Response.text(u.toString)))\n// res15: Handler[Any, Nothing, Any, Response] = zio.http.Handler$$anon$14@5b73a3a7\n')),(0,r.yg)("h3",{id:"from-zio-stream"},"From ZIO Stream"),(0,r.yg)("p",null,"ZIO HTTP uses ZIO Streams to handle streaming data. Using ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.fromStream")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.fromStreamChunked")," we can create handlers that produces a response from a ZIO Stream:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},(0,r.yg)("inlineCode",{parentName:"strong"},"Handler.fromStream")),"- Takes a ",(0,r.yg)("inlineCode",{parentName:"li"},"ZStream")," and the ",(0,r.yg)("inlineCode",{parentName:"li"},"contentLength"),", and produces a ",(0,r.yg)("inlineCode",{parentName:"li"},"Handler")," that returns a response with the given content length from the stream. It waits for the stream to complete before sending the response body. It has two variants, one for producing a response from a stream of ",(0,r.yg)("inlineCode",{parentName:"li"},"String")," and the other one for a stream of ",(0,r.yg)("inlineCode",{parentName:"li"},"Byte"),":")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"object Handler {\n  def fromStream[R](\n    stream: ZStream[R, Throwable, String],\n    contentLength: Long, charset: Charset = Charsets.Http\n  ): Handler[R, Throwable, Any, Response] = ???\n\n  def fromStream[R](\n    stream: ZStream[R, Throwable, Byte],\n    contentLength: Long\n  ): Handler[R, Throwable, Any, Response] = ???\n}\n")),(0,r.yg)("p",null,"Let's try an example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.http._\nimport zio.stream._\n\nRoutes(\n  Method.GET / "stream" ->\n    Handler\n      .fromStream(\n        stream = ZStream\n          .iterate(0)(_ + 1)\n          .intersperse("\\n")\n          .map(_.toString)\n          .schedule(Schedule.fixed(1.second)),\n        contentLength = 10,\n      )\n)\n')),(0,r.yg)("p",null,"In this example, when the client sends a GET request to /stream, the server responds with a stream of numbers separated by new lines. The content length of the response is set to 10, leading to the connection closing after the client receives a content body of size 10."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},(0,r.yg)("inlineCode",{parentName:"strong"},"Handler.fromChunkedStream")),"- Takes a ",(0,r.yg)("inlineCode",{parentName:"li"},"ZStream"),", and produces a ",(0,r.yg)("inlineCode",{parentName:"li"},"Handler")," that returns a chunked response from the stream. It sends the chunks as they are produced by the stream to the client. This is useful for streaming large files or when the content length of the stream is not known in advance. Like the ",(0,r.yg)("inlineCode",{parentName:"li"},"fromStream")," constructor, it has two variants:")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"object Handler {\n  def fromStreamChunked[R](\n    stream: ZStream[R, Throwable, String],\n    charset: Charset = Charsets.Http\n  ): Handler[R, Throwable, Any, Response] = ???\n\n  def fromStreamChunked[R](\n    stream: ZStream[R, Throwable, Byte]\n  ): Handler[R, Throwable, Any, Response] = ???\n}\n")),(0,r.yg)("p",null,"Now, let's try another example, this time using ",(0,r.yg)("inlineCode",{parentName:"p"},"fromStreamChunked"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.http._\nimport zio.stream._\n\nRoutes(\n  Method.GET / "stream" ->\n    Handler\n      .fromStreamChunked(\n        ZStream\n          .iterate(0)(_ + 1)\n          .intersperse("\\n")\n          .map(_.toString)\n          .schedule(Schedule.fixed(1.second)),\n      ).orDie\n)\n')),(0,r.yg)("p",null,"In this example, when the client sends a GET request to ",(0,r.yg)("inlineCode",{parentName:"p"},"/stream"),", the server responds with a stream of numbers separated by new lines. As the stream produces infinite numbers, the client receives the numbers as they are produced by the server."),(0,r.yg)("h3",{id:"from-html-text-and-template"},"From HTML, Text, and Template"),(0,r.yg)("h4",{id:"creating-a-plain-text-response"},"Creating a Plain Text Response"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.text")," constructor takes a ",(0,r.yg)("inlineCode",{parentName:"p"},"String")," and produces a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that returns a response with the given plain text content and the ",(0,r.yg)("inlineCode",{parentName:"p"},"Content-Type")," header set to ",(0,r.yg)("inlineCode",{parentName:"p"},"text/plain"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'Handler.text("Hello world!")\n')),(0,r.yg)("h4",{id:"creating-an-html-response"},"Creating an HTML Response"),(0,r.yg)("p",null,"ZIO HTTP has a DSL for creating HTML responses. To use it, we need to import the ",(0,r.yg)("inlineCode",{parentName:"p"},"zio.http.template._")," package. The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.html")," constructor takes an ",(0,r.yg)("inlineCode",{parentName:"p"},"Html")," element and produces a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that returns a response with the given HTML content and the ",(0,r.yg)("inlineCode",{parentName:"p"},"Content-Type")," header set to ",(0,r.yg)("inlineCode",{parentName:"p"},"text/html"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.http._\nimport zio.stream._\nimport zio.http.template._\n\nRoutes(\n  Method.GET / "html" ->\n    Handler.html(\n\n      html(\n        // Support for child nodes\n        head(\n          title("ZIO HTTP"),\n        ),\n        body(\n          div(\n            // Support for css class names\n            css := "container text-align-left",\n            h1("Hello World"),\n            ul(\n              // Support for inline css\n              styles := "list-style: none",\n              li(\n                // Support for attributes\n                a(href := "/hello/world", "Hello World"),\n              ),\n              li(\n                a(href := "/hello/world/again", "Hello World Again"),\n              ),\n\n              // Support for Seq of Html elements\n              (2 to 10) map { i =>\n                li(\n                  a(href := s"/hello/world/i", s"Hello World $i"),\n                )\n              },\n            ),\n          ),\n        ),\n      )\n    )\n)\n')),(0,r.yg)("h4",{id:"creating-an-html-response-using-template"},"Creating an HTML Response Using Template"),(0,r.yg)("p",null,"ZIP HTTP has a simple built-in template which is useful for creating simple HTML pages with minimal effort. Let's see an example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.http._\nimport zio.http.template._\n\nRoutes(\n  Method.GET / "hello" -> \n    Handler.template("Hello world!")(\n      html(\n        body(\n          p("This is a simple HTML page.")\n        )\n      )\n    )\n)\n')),(0,r.yg)("p",null,"Let's see what happens if the client requests the above route:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-curl"},'$> curl -i http://127.0.0.1:8080/hello\nHTTP/1.1 200 OK\ncontent-type: text/html\ncontent-length: 352\n\n<!DOCTYPE html><html><head><title>ZIO HTTP - Hello world!</title><style>\n body {\n   font-family: monospace;\n   font-size: 16px;\n   background-color: #edede0;\n }\n</style></head><body><div style="margin:auto;padding:2em 4em;max-width:80%"><h1>Hello world!</h1><html><body><p>This is a simple Hello, World! HTML page.</p></body></html></div></body></html>\u23ce\n')),(0,r.yg)("h3",{id:"timeout-handler"},"Timeout Handler"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.timeout")," takes a ",(0,r.yg)("inlineCode",{parentName:"p"},"Duration")," and returns a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that times out after the given duration with ",(0,r.yg)("inlineCode",{parentName:"p"},"408")," status code."),(0,r.yg)("h3",{id:"status-codes"},"Status Codes"),(0,r.yg)("p",null,"ZIO HTTP provides a set of constructors for creating handlers that return responses with specific status codes. Here are some of the common ones:"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Handler"),(0,r.yg)("th",{parentName:"tr",align:null},"HTTP Status Code"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.ok")),(0,r.yg)("td",{parentName:"tr",align:null},"200")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.badRequest")),(0,r.yg)("td",{parentName:"tr",align:null},"400")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.forbidden")),(0,r.yg)("td",{parentName:"tr",align:null},"403")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.tooLarge")),(0,r.yg)("td",{parentName:"tr",align:null},"413")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.notFound")),(0,r.yg)("td",{parentName:"tr",align:null},"404")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.methodNotAllowed")),(0,r.yg)("td",{parentName:"tr",align:null},"405")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.internalServerError")),(0,r.yg)("td",{parentName:"tr",align:null},"500")))),(0,r.yg)("p",null,"If we need to create a handler that returns a response with a specific status code other than the ones listed above, we can use the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.status")," constructor."),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.status")," constructor creates a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that always responds with the same status code and empty data:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"Handler.status(Status.Ok)\n")),(0,r.yg)("h3",{id:"handlererror"},"Handler.error"),(0,r.yg)("p",null,"Creates a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that always fails with the given error."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"Handler.error(Status.Forbidden)\n")),(0,r.yg)("h3",{id:"creating-a-handler-from-body"},"Creating a Handler From Body"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.fromBody")," constructor takes a ",(0,r.yg)("inlineCode",{parentName:"p"},"Body")," and produces a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that always returns a response with the given body with a 200 status code."),(0,r.yg)("h3",{id:"creating-a-bounded-body-consumer"},"Creating a Bounded Body Consumer"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.asChunkBounded")," constructor takes a ",(0,r.yg)("inlineCode",{parentName:"p"},"Request")," and the maximum size of the body in bytes (",(0,r.yg)("inlineCode",{parentName:"p"},"limit"),"), and produces a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that consumes the body of the request and returns a chunk of bytes. If the body size of the request exceeds the given limit, the handler throws an exception:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.http._\nimport zio.stream._\nimport zio.schema.codec.JsonCodec.zioJsonBinaryCodec\n\nRoutes(\n  Method.POST / "bounded-body-consumer" ->\n    handler { (request: Request) =>\n      Handler\n        .asChunkBounded(request, limit = 10)\n        .map { x: Chunk[Byte] =>\n          Response(body = Body.fromStream(ZStream.fromChunk(x)))\n        }.orDie\n    }.flatten\n)\n')),(0,r.yg)("h3",{id:"from-function"},"From Function"),(0,r.yg)("p",null,"To create a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," using a pure function, use ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.fromFunction"),". It takes a function from ",(0,r.yg)("inlineCode",{parentName:"p"},"In")," to ",(0,r.yg)("inlineCode",{parentName:"p"},"Out")," (",(0,r.yg)("inlineCode",{parentName:"p"},"Int => Out"),") and returns a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that takes ",(0,r.yg)("inlineCode",{parentName:"p"},"In")," and returns ",(0,r.yg)("inlineCode",{parentName:"p"},"Out")," (",(0,r.yg)("inlineCode",{parentName:"p"},"Handler[Any, Nothing, In, Out]"),")."),(0,r.yg)("p",null,"The following example shows how to create a handler that takes an ",(0,r.yg)("inlineCode",{parentName:"p"},"Int")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"Request")," from the input and returns a ",(0,r.yg)("inlineCode",{parentName:"p"},"Response"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.json._\nimport zio.http._\n\nRoutes(\n  Method.GET / "users" / int("userId")  ->\n    Handler.fromFunction[(Int, Request)] { case (userId: Int, request: Request) =>\n      Response.json(\n        Map(\n          "user"          -> userId.toString,\n          "correlationId" -> request.headers.get("X-Correlation-ID").get,\n        ).toJsonPretty,\n      )\n    }\n)\n// res24: Routes[Any, Nothing] = Routes(\n//   routes = IndexedSeq(\n//     Unhandled(\n//       routePattern = RoutePattern(\n//         method = GET,\n//         pathCodec = Concat(\n//           left = Concat(\n//             left = Segment(segment = Empty),\n//             right = Segment(segment = Literal(value = "users")),\n//             combiner = zio.http.codec.Combiner$$anon$1@146c11c3\n//           ),\n//           right = Segment(segment = IntSeg(name = "userId")),\n//           combiner = zio.http.codec.Combiner$$anon$1@226a8e58\n//         )\n//       ),\n//       handler = zio.http.Handler$FromFunction$$anon$16@148238cf,\n//       zippable = zio.ZippableLowPriority3$$anon$23@522acf63,\n//       location = "repl.MdocSession.MdocApp.res24(handler.md:324)"\n//     )\n//   )\n// )\n')),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.fromFunction")," has some variants that are useful in different scenarios:"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Constructor"),(0,r.yg)("th",{parentName:"tr",align:null},"Input Function"),(0,r.yg)("th",{parentName:"tr",align:null},"Output"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.fromFunction")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"In => Out")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler[Any, Nothing, In, Out]"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.fromFunctionHandler")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"In => Handler[R, Err, In, Out]")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler[R, Err, In, Out]"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.fromFunctionExit")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"In => Exit[Err, Out]")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler[Any, Err, In, Out]"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.fromFunctionZIO")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"In => ZIO[R, Err, Out]")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler[R, Err, In, Out]"))))),(0,r.yg)("h3",{id:"from-file"},"From File"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.fromFile")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.fromFileZIO")," constructors are used to create handlers that return a file from the server:"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Constructor"),(0,r.yg)("th",{parentName:"tr",align:null},"Input Function"),(0,r.yg)("th",{parentName:"tr",align:null},"Output"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.fromFile")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"File")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler[R, Throwable, Any, Response]"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler.fromFileZIO")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"ZIO[R, Throwable, File]")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler[R, Throwable, Any, Response]"))))),(0,r.yg)("p",null,"Let's see an example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.http._\nimport java.io.File\n\nRoutes(\n  Method.GET / "video" -> \n    Handler.fromFile(new File("src/main/resources/TestVideoFile.mp4")),\n  Method.GET / "text"  -> \n    Handler.fromFile(new File("src/main/resources/TestFile.txt")),\n)\n')),(0,r.yg)("h3",{id:"parameter-extractor"},"Parameter Extractor"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.param")," is a builder that takes a type parameter ",(0,r.yg)("inlineCode",{parentName:"p"},"A")," and returns a ",(0,r.yg)("inlineCode",{parentName:"p"},"ParamExtractorBuilder[A]")," which is used to extract a parameter from the input. It is useful when we have set of small handlers that are working with only part of the request, so we can extract the part that is required and pass it to the corresponding handler. All these handlers have unified input but may have different output types; this is where we can easily combine them using monadic composition."),(0,r.yg)("p",null,"Here is an example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.http._\n\nRoutes(\n  Method.GET / "static" / trailing -> handler {\n    // Path extractor\n    val pathExtractor: Handler[Any, Nothing, (Path, Request), Path] = \n      Handler.param[(Path, Request)](_._1)\n\n    // Request extractor\n    val requestExtractor: Handler[Any, Nothing, (Path, Request), Request] =\n      Handler.param[(Path, Request)](_._2)\n\n    def logRequest(request: Request): Handler[Any, Throwable, Request, Response] = ???\n    def staticFileHandler(path: Path): Handler[Any, Throwable, Request, Response] = ???\n\n    for {\n      path    <- pathExtractor\n      request <- requestExtractor\n      _       <- logRequest(request).contramap[(Path,Request)](_._2)\n      resp    <- staticFileHandler(path).contramap[(Path, Request)](_._2)\n    } yield (resp)\n  }.sandbox\n)\n')),(0,r.yg)("h3",{id:"websocket"},"Websocket"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.webSocket")," constructor takes a function of type ",(0,r.yg)("inlineCode",{parentName:"p"},"WebSocketChannel => ZIO[Env, Throwable, Any]")," and returns a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that handles the WebSocket requests."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"object Handler {\n  final def webSocket[Env](\n    f: WebSocketChannel => ZIO[Env, Throwable, Any],\n  ): WebSocketApp[Env] = ???\n}\n")),(0,r.yg)("p",null,"The following example shows how to create an echo server using the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.webSocket")," constructor:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.http._\nimport zio.http.ChannelEvent._\n\nRoutes(\n  Method.GET / "websocket" ->\n    handler {\n      Handler.webSocket { channel =>\n        channel.receiveAll {\n          case Read(WebSocketFrame.Text(text)) =>\n            channel.send(Read(WebSocketFrame.Text(text)))\n          case _                               => \n            ZIO.unit\n        }\n      }.toResponse\n    }\n)\n')),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"To be able to create a complete route, we need to convert the ",(0,r.yg)("inlineCode",{parentName:"p"},"WebSocketApp")," to a ",(0,r.yg)("inlineCode",{parentName:"p"},"Response")," using the ",(0,r.yg)("inlineCode",{parentName:"p"},"toResponse")," method.")),(0,r.yg)("h3",{id:"stack-trace"},"Stack Trace"),(0,r.yg)("p",null,"By using ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.stackTrace")," we can create a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that captures the ZIO stack trace at the current point:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"object Handler {\n  def stackTrace(implicit trace: Trace): Handler[Any, Nothing, Any, StackTrace] =\n    fromZIO(ZIO.stackTrace)\n}\n")),(0,r.yg)("p",null,"Let's try an example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.http._\n\nRoutes(\n  Method.GET / "stacktrace" ->\n    handler {\n      for {\n        stack <- Handler.stackTrace\n      } yield Response.text(stack.prettyPrint)\n    }\n)\n')),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"Returning a full stack trace in the body of an HTTP response is generally not recommended for production environments. Stack traces can contain sensitive information about your application's internals, which could be exploited by attackers."),(0,r.yg)("p",{parentName:"admonition"},"A better practice is to log the stack trace on the server side for debugging purposes and return a more user-friendly error message to the client. This approach provides clients with a clear understanding of what went wrong. We will delve into error handling in a separate section.")),(0,r.yg)("h2",{id:"handler-operators"},"Handler Operators"),(0,r.yg)("p",null,"Like",(0,r.yg)("inlineCode",{parentName:"p"},"ZIO")," data type, the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," has various operators for various operators for handling errors, timing out, combining handlers, maping "),(0,r.yg)("h3",{id:"handler-aspect"},"Handler Aspect"),(0,r.yg)("p",null,"To attach a handler aspect to a handler, we use the ",(0,r.yg)("inlineCode",{parentName:"p"},"@@")," operator. For instance, the following code shows an example where we attach a logging handler to the echo handler:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.http._\n\nRoutes(\n  Method.GET / "echo" -> handler { req: Request =>\n    Handler.fromBody(req.body)\n  }.flatten @@ HandlerAspect.requestLogging()\n)\n')),(0,r.yg)("p",null,"This will log every request coming to these handlers. ZIO HTTP supports various ",(0,r.yg)("inlineCode",{parentName:"p"},"HandlerAspects")," that you can learn about in the ",(0,r.yg)("a",{parentName:"p",href:"/zio-http/reference/aop/middleware"},"Middleware")," section."),(0,r.yg)("h3",{id:"sandboxing-errors"},"Sandboxing Errors"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#sandbox")," operator described is a potentially time-saving solution for managing errors within an HTTP application. Its primary function is the elimination of errors by translating them into an error of type ",(0,r.yg)("inlineCode",{parentName:"p"},"Response"),", allowing developers to transition into a controlled environment where errors are effectively mitigated:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"sealed trait Handler[-R, +Err, -In, +Out] { self =>\n  def sandbox: Handler[R, Response, In, Out]\n}\n")),(0,r.yg)("p",null,"This tool could serve as a shortcut for developers who wish to bypass the complication of error handling, enabling them to focus more on other aspects of their code."),(0,r.yg)("p",null,"Let's see an example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio.http._\nimport java.nio.file._\n\nRoutes(\n  Method.GET / "file" ->\n    Handler.fromFile(Paths.get("file.txt").toFile).sandbox,\n)\n')),(0,r.yg)("p",null,"In this example, the type of the handler before applying the ",(0,r.yg)("inlineCode",{parentName:"p"},"sandbox")," operator is ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler[Any, Throwable, Any, Response]"),". After applying the ",(0,r.yg)("inlineCode",{parentName:"p"},"sandbox")," operator, the type of the handler becomes ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler[Any, Response, Any, Response]"),"."),(0,r.yg)("p",null,"Without the ",(0,r.yg)("inlineCode",{parentName:"p"},"sandbox")," operator, the compiler would complain about the unhandled ",(0,r.yg)("inlineCode",{parentName:"p"},"Throwable")," error."),(0,r.yg)("h3",{id:"converting-a-handler-to-an-routes"},"Converting a ",(0,r.yg)("inlineCode",{parentName:"h3"},"Handler")," to an ",(0,r.yg)("inlineCode",{parentName:"h3"},"Routes")),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#toRoutes")," operator, converts a handler to an ",(0,r.yg)("inlineCode",{parentName:"p"},"Routes")," to be served by the ",(0,r.yg)("inlineCode",{parentName:"p"},"Server"),'. The following example, shows an HTTP application that serves a simple "Hello, World!" response for all types of incoming requests:'),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'import zio._\nimport zio.http._\n\nobject HelloWorldServer extends ZIOAppDefault {\n  def run =\n    Server\n      .serve(Handler.fromResponse(Response.text("Hello, world!")).toRoutes)\n      .provide(Server.default)\n}\n')),(0,r.yg)("h3",{id:"response-projections"},"Response Projections"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#header"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#headers"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#status"),", and ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#body")," operators are used to extract specific parts of the response from a handler's output:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"trait Handler[-R, +Err, -In, +Out] {\n  def header(headerType: HeaderType)(\n    implicit ev: Out <:< Response\n  ): Handler[R, Err, In, Option[headerType.HeaderValue]]\n  def headers(implicit ev: Out <:< Response): Handler[R, Err, In, Headers]\n  def status(implicit ev: Out <:< Response, trace: Trace): Handler[R, Err, In, Status]\n  def body(implicit trace: Trace): Handler[R, Err, In, Body]\n}\n")),(0,r.yg)("h3",{id:"running-handler"},"Running Handler"),(0,r.yg)("p",null,"We know that a handler is just a function that takes an input and returns an output:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"trait Handler[-R, +Err, -In, +Out] {\n  def apply(in: In): ZIO[R, Err, Out]\n}\n")),(0,r.yg)("p",null,"So, to run a handler, we just need to call the ",(0,r.yg)("inlineCode",{parentName:"p"},"apply")," method with the required input, and it will return a ",(0,r.yg)("inlineCode",{parentName:"p"},"ZIO")," effect. The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#runZIO")," is an alternative to the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#apply")," method."),(0,r.yg)("p",null,"In cases where the input type of handler is ",(0,r.yg)("inlineCode",{parentName:"p"},"Request"),", we can use the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#run")," method:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"trait Handler[-R, +Err, -In, +Out] {\n  def run(\n    method: Method = Method.GET,\n    path: Path = Path.root,\n    headers: Headers = Headers.empty,\n    body: Body = Body.empty,\n  )(implicit ev: Request <:< In): ZIO[R, Err, Out]\n}\n")),(0,r.yg)("h3",{id:"mapping"},"Mapping"),(0,r.yg)("p",null,"Like ",(0,r.yg)("inlineCode",{parentName:"p"},"ZIO")," data type, the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," has various operators for mapping the input and output types, and error types:"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Operator"),(0,r.yg)("th",{parentName:"tr",align:null},"Explanation"),(0,r.yg)("th",{parentName:"tr",align:null},"Variations"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler#map*")),(0,r.yg)("td",{parentName:"tr",align:null},"Used to transform the output of a handler."),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"map"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"mapError"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"mapErrorCause"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"mapZIO"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"mapErrorZIO"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"mapErrorCauseZIO"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler#contramap*")),(0,r.yg)("td",{parentName:"tr",align:null},"Used to transform the input of a handler."),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"contramap"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"contramapZIO"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"Handler#mapError*")),(0,r.yg)("td",{parentName:"tr",align:null},"Used to transform the error type of a handler."),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"mapError"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"mapErrorCause"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"mapErrorZIO"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"mapErrorCauseZIO"))))),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"If you're unfamiliar with these operators, it's recommended to explore the ",(0,r.yg)("a",{parentName:"p",href:"https://zio.dev/reference/"},"core ZIO documentation")," for a deeper understanding of their functionality.")),(0,r.yg)("h3",{id:"composing-handlers"},"Composing Handlers"),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"flatMap")," \u2014 This function is utilized to compose two handlers in scenarios where we aim to employ monadic composition. It combines the output of the first handler with the input of the second handler. The ",(0,r.yg)("inlineCode",{parentName:"p"},">>=")," operator serves as an alias for ",(0,r.yg)("inlineCode",{parentName:"p"},"flatMap"),".")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"andThen")," \u2014 Employed to sequentially compose a handler with another handler, without the need for monadic composition. Given two handlers, ",(0,r.yg)("inlineCode",{parentName:"p"},"h1: A => B")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"h2: B => C"),", the resulting function ",(0,r.yg)("inlineCode",{parentName:"p"},"A => C")," is achieved through ",(0,r.yg)("inlineCode",{parentName:"p"},"h1 andThen h2"),". The ",(0,r.yg)("inlineCode",{parentName:"p"},">>>")," operator acts as an alias for ",(0,r.yg)("inlineCode",{parentName:"p"},"andThen"),".")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"compose")," \u2014 This function functions as the inverse of ",(0,r.yg)("inlineCode",{parentName:"p"},"andThen"),". When provided with two handlers, ",(0,r.yg)("inlineCode",{parentName:"p"},"h1: B => C")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"h2: A => B"),", it returns the function ",(0,r.yg)("inlineCode",{parentName:"p"},"A => C")," via ",(0,r.yg)("inlineCode",{parentName:"p"},"h1 compose h2"),". The ",(0,r.yg)("inlineCode",{parentName:"p"},"<<<")," operator is an alias for ",(0,r.yg)("inlineCode",{parentName:"p"},"compose"),".")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"zip")," \u2014 Utilized to merge two handlers into a singular handler, producing a tuple comprising the outputs of both handlers. ",(0,r.yg)("inlineCode",{parentName:"p"},"zipLeft")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"zipRight")," are utilized when only one handler's output is of interest. The ",(0,r.yg)("inlineCode",{parentName:"p"},"zip")," operator is alias for ",(0,r.yg)("inlineCode",{parentName:"p"},"zip"),", while ",(0,r.yg)("inlineCode",{parentName:"p"},"<*")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"*>")," serve as aliases for ",(0,r.yg)("inlineCode",{parentName:"p"},"zipLeft")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"zipRight")," respectively.")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"orElse")," \u2014 This function combines two handlers into one, attempting the first handler and proceeding to the second if the first one fails. The ",(0,r.yg)("inlineCode",{parentName:"p"},"<>")," operator is an alias for ",(0,r.yg)("inlineCode",{parentName:"p"},"orElse"),"."))),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Operator"),(0,r.yg)("th",{parentName:"tr",align:null},"Explanation"),(0,r.yg)("th",{parentName:"tr",align:null},"Variations"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"flatMap"),(0,r.yg)("td",{parentName:"tr",align:null},"Used to compose two handlers using monadic composition."),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"flatMap"),", ",(0,r.yg)("inlineCode",{parentName:"td"},">>="))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"andThen"),(0,r.yg)("td",{parentName:"tr",align:null},"Feed the output of the first handler to input of the next handler."),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"andThen"),", ",(0,r.yg)("inlineCode",{parentName:"td"},">>>"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"compose"),(0,r.yg)("td",{parentName:"tr",align:null},"Feed the output of the next handler to input of the first handler."),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"compose"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"<<<"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"zip"),(0,r.yg)("td",{parentName:"tr",align:null},"Combines two handlers into one returning a tuple of outputs."),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"zip"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"zipLeft"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"zipRight"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"<*>")," ",(0,r.yg)("inlineCode",{parentName:"td"},"<*"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"*>"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"orElse"),(0,r.yg)("td",{parentName:"tr",align:null},"Combines two handlers, trying the first and then the second."),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"orElse"),", ",(0,r.yg)("inlineCode",{parentName:"td"},"<>"))))),(0,r.yg)("h3",{id:"error-management"},"Error Management"),(0,r.yg)("p",null,"Like ",(0,r.yg)("inlineCode",{parentName:"p"},"ZIO")," data type, the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," has various operators for handling errors, such as ",(0,r.yg)("inlineCode",{parentName:"p"},"orDie*"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"refineOrDie"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"catchAll*"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"unrefine*"),"."),(0,r.yg)("p",null,"The are similar to the ",(0,r.yg)("inlineCode",{parentName:"p"},"ZIO")," ones, but they are specialized for the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," type. If you're unfamiliar with these operators, it's recommended to explore the ",(0,r.yg)("a",{parentName:"p",href:"https://zio.dev/reference/error-management/"},"Error Management")," section in the core ZIO documentation."),(0,r.yg)("h3",{id:"working-with-environment-and-layers"},"Working with Environment and Layers"),(0,r.yg)("p",null,"The first type parameter of the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," is the environment type. This means that a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," can require an environment to run, like a ",(0,r.yg)("inlineCode",{parentName:"p"},"ZIO")," effect. When we create a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler"),", we can get access to the environment using ",(0,r.yg)("inlineCode",{parentName:"p"},"ZIO.service*")," methods, and finally, we can provide the environment using ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#provide*")," methods."),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"Please note that in most cases, we are not required to provide the environment of the handler in the middle of the routes definition. It is usually done at the end when we are creating the ",(0,r.yg)("inlineCode",{parentName:"p"},"Routes")," using the ",(0,r.yg)("inlineCode",{parentName:"p"},"Server#serve")," method.")),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"If you are not familiar with the concept of environment and layers in ZIO, it is recommended to explore the ",(0,r.yg)("a",{parentName:"p",href:"https://zio.dev/reference/contextual/"},"Introduction to the ZIO's Contextual Data Types")," section in the core ZIO documentation.")),(0,r.yg)("h3",{id:"adding-delays"},"Adding Delays"),(0,r.yg)("p",null,"When we have andler of type ",(0,r.yg)("inlineCode",{parentName:"p"},"In => Out"),", we can delay the consumption of the input by using the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#delayBefore")," and delay the production of the output by using the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#delayAfter"),"."),(0,r.yg)("h3",{id:"converting-to-constant-valuestypes"},"Converting to Constant Values/Types"),(0,r.yg)("p",null,"To convert a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," to a constant value, we can use the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#as")," method. It takes a value of type ",(0,r.yg)("inlineCode",{parentName:"p"},"Out")," and returns a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," that always returns the given value."),(0,r.yg)("p",null,"We can also narrow or widen the type of environment, error, input, or output of a ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler")," using the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#asEnvType"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#asErrorType"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#asInType"),", and ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler#asOutType")," methods."),(0,r.yg)("h3",{id:"overwriting-the-method"},"Overwriting the ",(0,r.yg)("inlineCode",{parentName:"h3"},"Method")),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.method")," overwrites the method in the incoming request to the ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"val handler11 = Handler.fromFunction((request: Request) => Response.text(request.method.toString))\nhandler11.method(Method.POST)\n")),(0,r.yg)("h3",{id:"patching-the-response"},"Patching the ",(0,r.yg)("inlineCode",{parentName:"h3"},"Response")),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Handler.patch")," patches the response produced by the request handler using a ",(0,r.yg)("inlineCode",{parentName:"p"},"Patch"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},'val handler12 = Handler.fromResponse(Response.text("Hello World!"))\nval handler13 = handler12.patch(Response.Patch.status(Status.Accepted))\n')))}g.isMDXComponent=!0}}]);